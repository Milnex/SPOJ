# -*- coding: utf-8 -*-
from sys import stderr
import urllib2

from shovel import task
from BeautifulSoup import BeautifulSoup



@task
def fetch(code):
    """Fetch problem information from SPOJ.

    Download problem description from SPOJ and then create a directory that 
    contains a problem description, a sample input file and an empty python 
    template automatically.

    Args:
        code - specify the SPOJ problem to be downloaded
    """
    if not code:
        print >> stderr, __doc__
        return

    print 'Problem #{0}: '.format(code)
    problem_url = 'http://www.spoj.pl/problems/{0}'.format(code)
    try:
        print 'Now downloading from {0} ...'.format(problem_url)
        problem_page = urllib2.urlopen(problem_url).read()
        soup = BeautifulSoup(problem_page.encode('utf-8', 'ignore'))
        print soup.findAll(True, "prob")

        #print 'Creating the directory {0} ...'#.format()
        #print 'Attaching problem details {0} ...'#.format()
        #print 'Attaching sample input file {0} ...'#.format()
        #print 'Attaching template file {0}...'#.format()
        #print 'Done.'
    except urllib2.URLError:
        print >> stderr, '[Error] No such problem: {0}'.format(code)

    return
